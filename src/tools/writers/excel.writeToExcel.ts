// 설치 필요: npm install xlsx
import * as XLSX from "xlsx";

// -----------------------------
// 1. 원본 텍스트
// -----------------------------
const rawText = `
오늘 데일리테스트는 일차부등식의 활용 범위 내에서 출제되었습니다. 정환 학생은 오늘 데일리테스트를 어려워했습니다. 기부액이 일정 금액 이상이기 위해 몇 개를 판매해야 하는지 구하는 문제(1번), 시속과 관련한 문제(2번), 최대 구매 가능 개수 구하는 문제(3번), 식의 값을 조건에 맞게 만드는 문제(5번) 에서 실수가 있었습니다. 그러나 평균 점수 조건 문제(4번) 는 올바르게 풀었습니다. 이번 시험에서 다소 어려운 부분이 있었지만, 꾸준한 노력과 성실함으로 성장하고 있습니다. 학습 과정에서 겪는 어려움도 차근차근 극복해 나가고 있으니, 앞으로도 지속적인 관심과 따뜻한 격려 부탁드립니다. 저희도 학생이 학업에 흥미와 자신감을 잃지 않도록 최선을 다해 지원하겠습니다.
오늘 데일리테스트는 일차부등식의 활용 범위 내에서 출제되었습니다. 준성 학생은 모든 문제를 맞췄습니다. 기부액이 일정 금액 이상이기 위해 몇 개를 판매해야 하는지 구하는 문제(1번), 시속과 관련한 문제(2번), 최대 구매 가능 개수 구하는 문제(3번), 평균 점수 조건 문제(4번), 식의 값을 조건에 맞게 만드는 문제(5번) 를 모두 올바르게 풀었습니다. 계속해서 노력을 이어가는 모습이 정말 멋집니다. 다음 수업도 기대할게요.
오늘 데일리테스트는 일차부등식의 활용 범위 내에서 출제되었습니다. 정환 학생은 오늘 데일리테스트를 어려워했습니다. 기부액이 일정 금액 이상이기 위해 몇 개를 판매해야 하는지 구하는 문제(1번), 시속과 관련한 문제(2번), 최대 구매 가능 개수 구하는 문제(3번), 평균 점수 조건 문제(4번), 식의 값을 조건에 맞게 만드는 문제(5번) 에서 실수가 있었습니다. 여러 문제에서 어려움을 겪었으나, 이는 학업 성장 과정에서 꼭 필요한 경험이라 생각합니다. 앞으로 점진적인 발전을 위해 수업과 가정에서 함께 노력하겠으며, 학부모님의 격려와 응원이 큰 힘이 될 것입니다. 함께 힘내서 더 좋은 결과를 만들어 가길 희망합니다.
오늘 데일리테스트는 일차부등식의 활용 범위 내에서 출제되었습니다. 현우 학생은 5문제 중에서 1문제가 오답이었습니다. 평균 점수 조건 문제(4번) 에서 실수가 있었습니다. 그러나 기부액이 일정 금액 이상이기 위해 몇 개를 판매해야 하는지 구하는 문제(1번), 시속과 관련한 문제(2번), 최대 구매 가능 개수 구하는 문제(3번), 식의 값을 조건에 맞게 만드는 문제(5번) 는 올바르게 풀었습니다. 수업에 참여하는 모습이 매우 훌륭했습니다. 앞으로도 계속 이어가길 바랍니다.
연우 학생은 시험에 미응시하였습니다.
주한 학생은 시험에 미응시하였습니다.
`;

// -----------------------------
// 2. 피드백 추출 (문단 기준 split)
// -----------------------------
// 줄바꿈 2개 이상을 기준으로 학생별 피드백 문단 분리
function extractFeedbackParagraphs(text: string): string[] {
  return text
    .split(/\n+/) // 줄바꿈 여러 개 기준 분리
    .map((p) => p.trim()) // 양쪽 공백 제거
    .filter((p) => p.length > 0); // 빈 문자열 제거
}

// -----------------------------
// 3. 지정 셀 좌표
// -----------------------------
const cellRanges = [
  ["F21", "K21"],
  ["N21", "S21"],
  ["V21", "AA21"],
  ["AD21", "AI21"],
  ["F22", "K22"],
  ["N22", "S22"],
  ["V22", "AA22"],
  ["AD22", "AI22"],
  ["F23", "K23"],
  ["N23", "S23"],
  ["V23", "AA23"],
  ["AD23", "AI23"],
  ["F24", "K24"],
  ["N24", "S24"],
  ["V24", "AA24"],
  ["AD24", "AI24"],
];

// -----------------------------
// 4. 엑셀 작성
// -----------------------------
const feedbacks = extractFeedbackParagraphs(rawText);
const workbook = XLSX.utils.book_new();
const worksheet: XLSX.WorkSheet = {};

// 학생별 피드백을 순서대로 셀에 배치
feedbacks.forEach((paragraph, idx) => {
  if (idx >= cellRanges.length) return; // 16개까지만

  const [startCell, endCell] = cellRanges[idx];
  worksheet[startCell] = { v: paragraph, t: "s" };

  // 병합 처리
  if (!worksheet["!merges"]) worksheet["!merges"] = [];
  worksheet["!merges"].push(XLSX.utils.decode_range(`${startCell}:${endCell}`));
});

// 시트 범위 지정
worksheet["!ref"] = "A1:AI30";

// 워크북 저장
XLSX.utils.book_append_sheet(workbook, worksheet, "피드백");
XLSX.writeFile(workbook, "daily_test_feedback_grid.xlsx");

console.log("✅ daily_test_feedback_grid.xlsx : 학생별 피드백 문단 입력 완료!");
